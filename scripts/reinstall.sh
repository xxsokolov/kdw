#!/bin/sh

# KDW Reinstaller
# Выполняет полную переустановку системы.

echo "--- KDW Reinstaller ---"

# Определяем путь к директории со скриптами
SCRIPT_DIR=$(dirname "$0")

# --- 1. Запуск удаления ---
echo "Шаг 1: Запуск полного удаления..."
sh "${SCRIPT_DIR}/uninstall.sh"
if [ $? -ne 0 ]; then
    echo "❌ Ошибка на этапе удаления. Переустановка прервана."
    exit 1
fi
echo "✅ Удаление завершено."
echo ""

# --- 2. Запуск установки ---
echo "Шаг 2: Запуск новой установки..."
# Мы предполагаем, что bootstrap.sh находится в той же директории, что и kdw_bot.py
# и другие компоненты, которые будут заново скачаны.
# Поэтому мы скачиваем и запускаем его заново из GitHub.
curl -sL https://raw.githubusercontent.com/xxsokolov/KDW/main/bootstrap.sh | sh
if [ $? -ne 0 ]; then
    echo "❌ Ошибка на этапе установки. Пожалуйста, попробуйте запустить bootstrap.sh вручную."
    exit 1
fi

echo "--- Переустановка успешно завершена! ---"

exit 0
